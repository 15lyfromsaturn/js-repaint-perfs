/*
 https://github.com/leeoniya/domvm (1.x-dev)
*/
("undefined"!==typeof global?global:this).domvm={};(function(v){var w=("undefined"==typeof window?{}:window).requestAnimationFrame,x={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,columnCount:!0,counterIncrement:!0,fillOpacity:!0,flex:!0,flexGrow:!0,flexOrder:!0,flexPositive:!0,flexShrink:!0,"float":!0,fontWeight:!0,gridColumn:!0,lineHeight:!0,lineClamp:!0,opacity:!0,order:!0,orphans:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0,tabSize:!0,transform:!0,transformOrigin:!0,widows:!0,zIndex:!0,zoom:!0},u={TYPE_ELEM:1,
TYPE_TEXT:2,isArr:function(d){return d instanceof Array},isVal:function(d){d=typeof d;return"string"===d||"number"===d},isObj:function(d){return"object"===typeof d&&null!==d&&!u.isArr(d)},isFunc:function(d){return"function"===typeof d},isProm:function(d){return"object"===typeof d&&u.isFunc(d.then)},execAll:function(d,h,r,q,t,v){var w;d&&(u.isArr(d)?d:[d]).forEach(function(d){w=d.call(null,h,r,q,t,v)});return w},tick:function(d,h){h&&w?w&&w(function(){u.tick(d,h-1)}):u.isArr(d)?d[0].apply(null,d.slice(1)):
d()},insertArr:function(d,h,r,q){d.splice.apply(d,[r,q].concat(h))},isEvProp:function(d){return"on"===d.substr(0,2)},isDynProp:function(d,h){switch(d){case "input":case "textarea":case "select":case "option":switch(h){case "value":case "checked":case "selected":case "selectedIndex":return!0}}},camelDash:function(d){return d.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},autoPx:function(d,h){return isNaN(h)||x[d]?h:h+"px"},deepSet:function(d,h,r){h=h.split(".");var q=h.pop();h.forEach(function(h){d[h]||
(d[h]={});d=d[h]});d[q]=r},deepGet:function(d,h){var r=h.split(".");do d=d[r.shift()];while(r.length);return d},keyedIdx:function(d,h,r,q,t){for(q=0;q<h.length;q++)if(t=h[q],t.key===d)if(r){if(t.vm&&t.vm.view[0]===r)return q}else return q;return-1},raft:function(d){function h(){r=0;d.apply(q,t)}if(!w)return d;var r,q,t;return function(){q=this;t=arguments;r||(r=w(h))}}};v.utils=u})(domvm);(function(v){function w(){for(var a;a=F.pop();)a[0].apply(null,a.slice(1))}function x(a,b){return!1===b?null:null==b&&null!=a?a:e.isVal(b)||e.isObj(b)||e.isArr(b)||e.isFunc(b)?b:null}function u(a,b,g,l,c,p){function m(a,b,c){if(c)a[b]=a[b]||[],a[b].push(c);else for(var g in b)a[g]=a[g]||[],a[g].push(b[g])}function f(a,b,g){c=a;p=b;n.update(g,!1);return q(0,!1)}function k(a){return null==a?"":a}function q(a,l){if(a){for(var f=n;a--&&f.parent;)f=f.parent;f.redraw(0,!0);return f.vm}(f=n.node)&&h(n,"willRedraw",
n);n.refs={};var d=n.render.call(n.api,n,b,g),d=t(d,c,p,n);d.vm=n;n.node=d;var k=e.isVal(g)&&"^"===g[0]?g.substr(1):e.isVal(d.ref)&&"^"===d.ref[0]?d.ref.substr(1):null;d.key=null!=g?g:d.key;for(var m=c;m;)m.vm&&(n.parent||(n.parent=m.vm),null!==k&&e.deepSet(m.vm.refs,k,d)),m=m.parent;if((k=f)&&(d.type!==f.type||d.tag!==f.tag))var k=null,v=!0,G=f.el.parentNode;z(d,k);c&&(c.body[p]=d);!1!==l&&(f&&r(f),!f&&u||A(d,null,d.el),v&&(G||d.parent.el).insertBefore(d.el,G.childNodes[f.idx]));f&&h(n,"didRedraw",
n);!1!==l&&e.tick(w,2);return n}var u=!c;e.isArr(a)&&(b=a[1],g=a[2],l=a[3],a=a[0]);g=x(b,g);var n={api:{},node:null,view:[a,g],model:b,opts:l||{},render:null,update:function(a,c){null==a||g===b&&!e.isVal(g)||(b=n.model=a);return!1!==c?q(0):n},on:function(a,b){m(n.events,a,b)},hook:function(a,b){n.hooks=n.hooks||{};m(n.hooks,a,b)},events:{},hooks:null,redraw:B.useRaf?e.raft(q):q,patch:function(a,b){var c=null!=a.el;if(e.isObj(b)){var g="class"in b?(k(a["class"])+" "+k(b["class"])).trim():a.props["class"],
l="style"in b?b.style:a.props.style;c&&(c=Object.create(a.props),c["class"]=g,c.style=l,c={tag:a.tag,el:a.el,ns:a.ns,props:c},C(c,a));a.props["class"]=g;a.props.style=l}else g=a.parent,c=z(t(b,g,a.idx,n),a),g.body[a.idx]=c},emit:function(a){for(var b=Array.prototype.slice.call(arguments),c=n,g;c;){if(g=c.events[a]){b[0]=g;e.execAll.apply(null,b);break}c=c.parent}},refs:{},parent:null,mount:function(a,b){var c=null;b&&(a.textContent="",c=a,a=null);A(n.node,c,null,a);return n},attach:function(a){d(n.node,
a);return n},unmount:function(){r(n.node)},moveTo:f,updIdx:function(a){p=a}};l&&l.hooks&&n.hook(l.hooks);e.execAll(y,n);n.render=a.call(n.api,n,b,g);return c?f(c,p):q(0)}function d(a,b){a.el=b;b._node=a;for(var g in a.props){var l=a.props[g],c=e.isEvProp(g)?g:"."===g[0]?g.substr(1):null;null!==c&&(b[c]=l)}if(e.isArr(a.body))for(g=0;g<a.body.length;g++)d(a.body[g],b.childNodes[g])}function h(a,b,g,l,c,d){if(a&&a.hooks&&(a=a.hooks[b]))if(B.useRaf&&"did"==b.substr(0,3))F.push([e.execAll,a,g,l,c,d]);
else return e.execAll(a,g,l,c,d)}function r(a,b){var g=a.el&&!a.moved;if(g){var l=h(a.vm,"willUnmount",a.vm),c=h(a,"willRemove",a),d=l||c;a.removed=!0}e.isArr(a.body)&&a.body.forEach(function(a,c){r(a,b||d)});b||(d?d.then(function(){q(a,g)}):q(a,g))}function q(a,b){null!=a.el&&a.el.parentNode&&(b&&(a.el.parentNode.removeChild(a.el),a.el=null,h(a.vm,"didUnmount",a.vm),h(a,"didRemove",a)),e.isArr(a.body)&&a.body.forEach(function(a,b){q(a,!0)}),a.vm=a.body=null)}function t(a,b,g,d){var c=a;a={type:null,
key:null,ref:null,idx:null,parent:null,moved:!1,removed:!1,hooks:null,tag:null,"class":null,ns:null,guard:!1,raw:!1,props:null,el:null,hasKeys:!1,body:null};e.isFunc(c)&&(c=c());if(e.isArr(c)&&c.length){a.type=e.TYPE_ELEM;if(1<c.length){var p=1;e.isObj(c[1])&&(a.props=c[1],p=2);a.body=c.length==p+1?e.isVal(c[p])?c[p]:e.isFunc(c[p])?c[p]():c.slice(p):c.slice(p)}c=c[0];if(/[.#]/.test(c)){if(c=K(c),a.tag=c.tag,p=null!=c["class"],null!=c.id||p){var m=a.props||{};null==m.id&&(m.id=c.id);p&&(a["class"]=
c["class"],m["class"]=c["class"]+(null!=m["class"]?" "+m["class"]:""));a.props=m}}else a.tag=c;if(a.props){var c=a.props,f;for(f in c)e.isEvProp(f)?c[f]=L(c[f],d.opts.evctx||d.model||null,a,d):e.isFunc(c[f])&&("href"==f?(c.onclick=c[f],c.href=c[f].href):c[f]=c[f]()),e.isDynProp(a.tag,f)&&(c["."+f]=c[f]);if(e.isObj(c.style))for(var k in c.style)f=c.style[k],e.isFunc(f)&&(c.style[k]=f());e.isObj(c._hooks)&&(a.hooks=c._hooks,c._hooks=null);a.key=e.isVal(c._key)?c._key:e.isVal(c._ref)?c._ref:e.isVal(c.id)?
c.id:e.isVal(c.name)?c.name:null;null!=c._ref&&(a.ref=c._ref);c._raw&&(a.raw=!0);null!=c._data&&(a.data=c._data);c._guard&&(a.guard=!0);c._ref=c._key=c._raw=c._data=c._guard=null}}else e.isVal(c)&&(a.type=e.TYPE_TEXT,a.body=c);null!==a.ref&&e.deepSet(d.refs,a.ref,a);a.parent=b;a.idx=g;a.ns=b&&b.ns?b.ns:"svg"===a.tag||"math"===a.tag?a.tag:null;if(e.isArr(a.body))for(b=0,g=a.body.length;b<g;b++){k=a.body[b];c=f=null;m=p=!1;e.isFunc(k)&&(k=k());if(null==k)p=!0;else{var h=e.isArr(k),q=h?!1:e.isObj(k);
if(h)k.length?"string"==typeof k[0]&&""!==k[0]?(c=t(k,a,b,d),f=c.key):e.isFunc(k[0])?f=x(k[1],k[2]):m=!0:p=!0;else if(q)if(e.isFunc(k.redraw))k.moveTo(a,b),c=k.node,f=k.view[1];else{a.body[b--]=""+k;continue}else""===k?p=!0:0<b&&a.body[b-1].type===e.TYPE_TEXT?(a.body[b-1].body+=""+k,p=!0):c=t(""+k,a,b,d)}p||m?(m?e.insertArr(a.body,k,b,1):a.body.splice(b,1),g=a.body.length,b--):(null!==f&&(a.hasKeys=!0),a.body[b]=c||k)}return a}function z(a,b){b&&(h(a,"willRecycle",b,a),M(b,a),h(a,"didRecycle",b,a));
if(e.isArr(a.body)){var g=0;a.body.forEach(function(d,c){var p=e.isArr(d);if(b){var m=J(d,a,b,g);if(null!==m){var f=m[0],m=m[1];f===g&&g++;f=b.body[f];f.vm?p?2===m?f.vm.moveTo(a,c,d[1]):1===m&&u(d[0],d[1],d[2],d[3],a,c):d.vm&&2===m&&d.vm===f.vm&&f.vm.moveTo(a,c):a.body[c]=z(d,f);return}}p?u(d[0],d[1],d[2],d[3],a,c):a.body[c]=z(d)})}return a}function A(a,b,d,l){for(var c=!a.el;d&&d._node.removed;)d=d.nextSibling;c&&h(a.vm,"willMount",a.vm);if(a.type==e.TYPE_ELEM)if(c&&(a.el=b||(a.ns?D.createElementNS(N[a.ns],
a.tag):D.createElement(a.tag)),a.props&&C(a)),e.isArr(a.body)){b=0;for(var p=a.el.firstChild;b<a.body.length;b++)p=A(a.body[b],null,p)}else e.isVal(a.body)&&(a.raw?a.el.innerHTML=a.body:c&&(a.el.textContent=a.body));else a.type==e.TYPE_TEXT&&c&&(a.el=D.createTextNode(a.body));a.el._node=a;b=a.parent;d!==a.el&&(l||b&&b.el)&&(b=c?"Insert":"Reinsert",h(a,"will"+b,a),(l||a.parent.el).insertBefore(a.el,d),h(a,"did"+b,a));c&&a.vm&&a.vm.hooks&&!a.moved&&h(a.vm,"didMount",a.vm);return d!==a.el?d:d.nextSibling}
function J(a,b,d,l,c){var p=e.isArr(a),m=p?x(a[1],a[2]):a.key,f=d.hasKeys,k=b.hasKeys;d=d.body;b=b.body;if(null!==m&&f)return a=e.keyedIdx(m,d,p?a[0]:null),-1<a?[a,2]:null;l=l||0;if(l>d.length-1)return null;c=0===c?0:c||d.length-1;for(m=null;l<=c;l++)if(f=d[l],null!==f&&f.el)if(p&&f.vm){if(f.vm.view[0]===a[0]){if(f.vm.view[1]===x(a[1],a[2]))return[l,2];!m&&k&&-1==e.keyedIdx(f.key,b,f.vm.view[0])&&(m=[l,1])}}else if(a.type===f.type&&(a.type===e.TYPE_TEXT||null!==a.tag&&a.tag===f.tag)&&(null===f.key||
!k||-1==e.keyedIdx(f.key,b,f.vm?f.vm.view[0]:null)))return[l,1];return m}function M(a,b){b.el=a.el;a.el=null;b.el&&(b.el._node=b);if(b.type===e.TYPE_TEXT&&b.body!==a.body)b.el.nodeValue=b.body;else{C(b,a);var d=!e.isArr(b.body),l=!e.isArr(a.body);d&&b.body!==a.body?l&&b.el.firstChild?b.el.firstChild.nodeValue=b.body:b.raw?b.el.innerHTML=b.body:b.el.textContent=b.body:l&&!d&&(b.el.textContent="");a.moved=!0}}function K(a){if(a in E)return E[a];var b={tag:null,id:null,"class":null};b.tag=a.replace(/^([\w\-]+)?(?:#([\w\-]+))?((?:\.[\w\-]+)+)?$/,
function(a,d,c,e){c&&(b.id=c);e&&(b["class"]=e.replace(/\./g," ").trim());return d||"div"});return E[a]=b}function L(a,b,d,l){return function(c){var d,g=c.target._node,f=null;if(e.isFunc(a))d=a.call(b,c,g,l);else if(e.isArr(a))f=a.slice(1),d=a[0].apply(b,f.concat(c,g,l));else if(e.isObj(a))for(var k in a){var h=a[k];c.target.matches(k)&&(e.isArr(h)?(f=h.slice(1),d=h[0].apply(b,f.concat(c,g,l))):e.isFunc(h)&&(d=h.call(b,c,g,l)))}!1===d&&(c.preventDefault(),c.stopPropagation());l.opts.hasOwnProperty("watch")&&
l.opts.watch.fire({type:"event",vm:l,node:g,event:c,data:f})}}function C(a,b){var d=!b;b=b||{};if(b.props||a.props){var l=b.props||{},c=a.props||{},h=l.style,m=c.style;if(e.isObj(h)||e.isObj(m))H(a.el,a.tag,h||{},m||{},O,P,a.ns,d),l.style=c.style=null;H(a.el,a.tag,l,c,Q,I,a.ns,d);m&&(c.style=m)}}function H(a,b,d,e,c,h,m,f){for(var k in e)null!==e[k]&&("."===k[0]?a[k.substr(1)]!==e[k]:e[k]!==d[k])&&c(a,k,e[k],m,f);for(k in d)null!==d[k]&&null==e[k]&&h(a,k,m,f)}function O(a,b,d){a.style[b]=e.autoPx(b,
d)}function P(a,b){a.style[b]=""}function Q(a,b,d,h,c){"."===b[0]?(b=b.substr(1),"svg"===h?a[b].baseVal=d:a[b]=d):"class"===b?a.className=d:"id"===b||e.isEvProp(b)?a[b]=d:!1===d?I(a,b,h,c):a.setAttribute(b,!0===d?"":d)}function I(a,b,d,h){h||("."===b[0]?(b=b.substr(1),"svg"===d?a[b].baseVal=null:a[b]=null):"class"===b?a.className="":"id"===b||e.isEvProp(b)?a[b]=null:a.removeAttribute(b))}var N={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},E={},D="undefined"==typeof document?
{}:document,F=[],B={useRaf:!0};v.view=u;v.view.config=function(a){B=a};var y=null;v.view.extend=function(a,b){y=!y||b?[]:y;y.push(a)};var e=v.utils;return v})(domvm);
